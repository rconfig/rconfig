import{K as p,ac as Le,ad as W,ae as re,r as B,af as Me,o as i,e as V,w as s,b as t,u as e,ag as je,m as Oe,ah as ie,ai as de,d as f,t as R,aj as ue,a as n,c as D,ak as E,al as q,am as Te,a6 as ze,n as ce,an as fe,ao as me,g as Fe,ap as Be,aq as pe,X as K,ar as X,as as Ne,q as Y,k as Z,l as ee,at as Q,au as Ue,p as te,av as Ae,E as j,aw as Ee,ax as qe,ay as A,az as He,aA as J,aB as ne,aC as oe,aD as Ke,aE as Ge,aF as Je,aG as Xe,aH as Qe,_ as ge,aI as We,aJ as _e,aK as Ye,aL as ae,aM as ve,aN as Ze,z as et,aO as tt,aP as st}from"./app-CVdXIL_t.js";import{u as le,a as xe,_ as ye,b as se,c as T,d as be,e as he,f as z,g as $e,h as ke,i as at,j as we,k as lt,l as nt,m as ot,n as rt,o as it,p as dt}from"./useRowSelection-cLYhQSsR.js";import{_ as ut,a as ct,b as ft,C as mt}from"./NavPills-By6RO7D0.js";import{_ as Ce}from"./useCopy-HcS652aP.js";import{_ as Se,a as Pe,b as Re,c as De,d as Ve}from"./SelectScrollDownButton-pqnd6qwD.js";import{_ as Ie}from"./SelectGroup-OvIwWA7u.js";import{_ as pt}from"./CardFooter.vue_vue_type_script_setup_true_lang-X8GSd3fF.js";/* empty css               */import"./RcToolTip.vue_vue_type_script_setup_true_lang-BQlQ5M_M.js";import"./BadgeList-BhrDNCsi.js";import"./HoverCardTrigger-DfMwAM_C.js";const gt={class:"flex justify-between"},_t={class:"flex items-center"},vt={class:"flex items-center"},xt={class:"grid gap-4 px-6 py-4 overflow-y-auto"},yt={class:"flex flex-col justify-between"},bt={key:1,class:"space-y-4"},ht={class:"mb-2"},$t={class:"text-sm font-medium rc-text-sm-muted underline"},kt=["innerHTML"],wt={__name:"PeekConfigSearchMatchesDialog",props:{editId:{type:Number,required:!0},record:{type:Object,required:!0},searchString:{type:String,required:!0}},setup(v){const c=le(),x=p({}),o=p(!0),y=p(localStorage.getItem("selectedLanguage")||"language-plaintext"),{closeDialog:u,isDialogOpen:h}=c,{copy:b,copied:m}=Le(),a=v,{matches:l}=a.record,k=["bash","c","cpp","css","html","java","javascript","language-plaintext","php","python","typescript"];W(()=>{window.addEventListener("keydown",M),o.value=!1});const L=w=>{if(!a.searchString||!w)return w;const $=Array.isArray(w)?w.join(`
`):String(w),N=a.searchString.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),C=new RegExp(`(${N})`,"gi");return $.replace(C,'<span class="highlightMatch">$1</span>').replace(/\n/g,"<br>")};function M(w){w.key==="Escape"&&I()}const d=Fe(()=>a.record.file);re(()=>{window.removeEventListener("keydown",M)});const P=w=>{x.value[w]=!0},g=w=>{x.value[w]=!1};function I(){u("peek-config-search-matches-dialog-"+a.editId)}return(w,$)=>{const N=B("RcIcon"),C=B("Button"),r=Me("highlightjs");return i(),V(e(me),{open:e(h)("peek-config-search-matches-dialog-"+v.editId)},{default:s(()=>[t(e(je),{"as-child":""},{default:s(()=>[Oe(w.$slots,"default")]),_:3}),t(e(ie),{class:"sm:max-w-[70dvw] grid-rows-[auto_minmax(0,1fr)_auto] p-0 max-h-[90dvh]",onEscapeKeyDown:$[5]||($[5]=S=>e(u)("peek-config-search-matches-dialog-"+v.editId)),onPointerDownOutside:$[6]||($[6]=S=>e(u)("peek-config-search-matches-dialog-"+v.editId)),onCloseClicked:$[7]||($[7]=S=>e(u)("peek-config-search-matches-dialog-"+v.editId))},{default:s(()=>[t(e(Ce),{class:"p-6 pb-0"},{default:s(()=>[t(e(de),null,{default:s(()=>[f("Configuration Quick Peek (Config ID: "+R(v.editId)+")",1)]),_:1}),t(e(ue),null,{default:s(()=>[n("div",gt,[n("div",_t,[$[8]||($[8]=n("div",{class:"mr-2"},"Language Options:",-1)),t(e(Se),{modelValue:y.value,"onUpdate:modelValue":$[0]||($[0]=S=>y.value=S)},{default:s(()=>[t(e(Pe),{class:"w-[180px]"},{default:s(()=>[t(e(Re),{placeholder:"Select a language"})]),_:1}),t(e(De),null,{default:s(()=>[t(e(Ie),null,{default:s(()=>[(i(),D(E,null,q(k,S=>t(e(Ve),{value:S,key:S},{default:s(()=>[f(R(S),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),n("div",vt,[f(" Path: "+R(d.value)+" ",1),n("span",{class:"ml-2 cursor-pointer",onMouseover:$[1]||($[1]=S=>P("fileLocation")),onMouseleave:$[2]||($[2]=S=>g("fileLocation")),onClick:$[3]||($[3]=S=>e(b)(d.value))},[t(N,{name:"copy-transition",isActive:e(m),size:16},null,8,["isActive"])],32)])])]),_:1})]),_:1}),n("div",xt,[n("div",yt,[o.value?(i(),V(Te,{key:0})):(i(),D("div",bt,[(i(!0),D(E,null,q(e(l),(S,U)=>(i(),D("div",{key:U,class:"context-block border rounded-lg p-4"},[n("div",ht,[n("span",$t," Matched Line: "+R(S.line_number),1)]),ze(n("pre",{class:ce([y.value,"whitespace-pre-wrap text-sm p-3 rounded border overflow-x-auto"]),innerHTML:L(S.context)},null,10,kt),[[r]])]))),128))]))])]),t(e(fe),{class:"p-6 pt-0"},{default:s(()=>[t(C,{onClick:$[4]||($[4]=S=>I()),variant:"outline"},{default:s(()=>[...$[9]||($[9]=[f(" Close ",-1)])]),_:1})]),_:1})]),_:1})]),_:3},8,["open"])}}};function Ct(v){const c=Be("formatters"),x=le(),{openDialog:o,closeDialog:y,isDialogOpen:u}=x,h=pe(),b=p(0),m=p([]),a=p(!1),l=p(1),k=p(1),L=xe(),M=p(L.get("useResultsTable","perPage",5)),d=p([]),P=Ne({device_name:"",command:"",device_category:"",search_string:"",lines_before:5,lines_after:5,latest_version_only:!0,ignore_case:!0,start_date:"",end_date:""});K(()=>v.filters,C=>{g(C),I()}),K(M,()=>{L.set("useResultsTable","perPage",M.value),I()});function g(C){d.value=[],m.value=[],b.value=0,l.value=1,k.value=1,Object.assign(P,C)}const I=async()=>{var C,r;a.value=!0;try{const S=await X.post("/api/configs/search",{device_name:P.device_name,command:P.command,device_category:P.device_category,search_string:P.search_string,lines_before:P.lines_before,lines_after:P.lines_after,latest_version_only:P.latest_version_only,ignore_case:P.ignore_case,start_date:P.start_date+" 00:00:00",end_date:P.end_date+" 23:59:59",page:k.value,per_page:M.value});S.data.data.length&&(d.value=S.data.data,b.value=S.data.current_page,l.value=S.data.last_page)}catch(S){console.log(S),m.value=((r=(C=S.response)==null?void 0:C.data)==null?void 0:r.errors)||[]}finally{a.value=!1}};function w(C){h.push({name:"config-view",params:{id:parseInt(C)},query:{ref:"configsearch"}})}function $(C){M.value=C,I()}function N(C){console.log(C),k.value=C,I()}return{changePage:N,currentPage:b,errors:m,formatters:c,isDialogOpen:u,isFetching:a,lastPage:l,openDialog:o,perPage:M,results:d,searchModel:P,updatePerpage:$,viewDetailsPane:w}}const St={class:"px-6"},Pt={class:"flex items-center border-b"},Rt={key:0,class:"flex items-center justify-center my-4"},Dt={key:0},Vt={key:1},It={key:2,class:"flex items-center justify-center pb-8"},Lt={__name:"ConfigSearchResultsTable",props:{filters:Object},setup(v){const c=v,{currentPage:x,errors:o,formatters:y,isDialogOpen:u,isFetching:h,lastPage:b,openDialog:m,perPage:a,results:l,searchModel:k,viewDetailsPane:L}=Ct(c);return(M,d)=>{const P=B("RcIcon");return i(),D("div",St,[t(e($e),null,{default:s(()=>[t(e(ye),null,{default:s(()=>[t(e(se),null,{default:s(()=>[t(e(T),{class:"w-[5%]"},{default:s(()=>[...d[2]||(d[2]=[f("ID",-1)])]),_:1}),t(e(T),{class:"w-[5%]"},{default:s(()=>[...d[3]||(d[3]=[f("Device",-1)])]),_:1}),t(e(T),{class:"w-[10%]"},{default:s(()=>[...d[4]||(d[4]=[f("Command Group",-1)])]),_:1}),t(e(T),{class:"w-[10%]"},{default:s(()=>[...d[5]||(d[5]=[f("Command",-1)])]),_:1}),t(e(T),{class:"w-[10%]"},{default:s(()=>[...d[6]||(d[6]=[f("Filesize",-1)])]),_:1}),t(e(T),{class:"w-[10%]"},{default:s(()=>[...d[7]||(d[7]=[f("Config date",-1)])]),_:1}),t(e(T),{class:"w-[10%]"},{default:s(()=>[...d[8]||(d[8]=[f("Matches",-1)])]),_:1}),t(e(T),{class:"w-[10%]"},{default:s(()=>[...d[9]||(d[9]=[f("Actions",-1)])]),_:1})]),_:1})]),_:1}),t(e(be),null,{default:s(()=>[e(h)?(i(),V(he,{key:0})):(i(!0),D(E,{key:1},q(e(l),g=>(i(),V(e(se),{key:g.id},{default:s(()=>[t(e(z),{class:"text-start"},{default:s(()=>[f(R(g.id),1)]),_:2},1024),t(e(z),{class:"text-start"},{default:s(()=>[f(R(g.device_name),1)]),_:2},1024),t(e(z),{class:"text-start"},{default:s(()=>[f(R(g.device_category),1)]),_:2},1024),t(e(z),{class:"text-start"},{default:s(()=>[f(R(g.command),1)]),_:2},1024),t(e(z),{class:"text-start"},{default:s(()=>[f(R(e(y).formatFileSize(g.config_filesize)),1)]),_:2},1024),t(e(z),{class:"text-start"},{default:s(()=>[f(R(e(y).formatTime(g.config_date)),1)]),_:2},1024),t(e(z),{class:"text-start"},{default:s(()=>[t(e(Y),null,{default:s(()=>[t(e(Z),null,{default:s(()=>[t(e(ee),{"as-child":""},{default:s(()=>[t(e(Q),{variant:"ghost",onClick:I=>e(m)("peek-config-search-matches-dialog-"+g.id),class:"px-2 py-0 hover:bg-rcgray-800 rounded-xl"},{default:s(()=>[n("span",Pt,[t(e(Ue),{class:"mr-2 text-muted-foreground hover:text-blue-500",size:"16"}),f(" "+R(g.matches.length?g.matches.length:"No")+" match"+R(g.matches.length>1?"es":""),1)])]),_:2},1032,["onClick"])]),_:2},1024),t(e(te),{class:"text-white bg-rcgray-800"},{default:s(()=>[...d[10]||(d[10]=[n("p",null,"View Matches",-1)])]),_:1})]),_:2},1024)]),_:2},1024)]),_:2},1024),t(e(z),{class:"flex items-center"},{default:s(()=>[t(e(Y),null,{default:s(()=>[t(e(Z),null,{default:s(()=>[t(e(ee),{"as-child":""},{default:s(()=>[t(e(Q),{variant:"ghost",onClick:I=>e(m)("peek-config-dialog-"+g.id)},{default:s(()=>[t(P,{name:"peek-eye"})]),_:1},8,["onClick"])]),_:2},1024),t(e(te),{class:"text-white bg-rcgray-800"},{default:s(()=>[...d[11]||(d[11]=[n("p",null,"Peek Config",-1)])]),_:1})]),_:2},1024)]),_:2},1024),t(e(Y),null,{default:s(()=>[t(e(Z),null,{default:s(()=>[t(e(ee),{"as-child":""},{default:s(()=>[t(e(Q),{variant:"ghost",onClick:I=>e(L)(g.id)},{default:s(()=>[t(e(Ae),{class:"size-5 text-muted-foreground hover:text-blue-500"})]),_:1},8,["onClick"])]),_:2},1024),t(e(te),{class:"text-white bg-rcgray-800"},{default:s(()=>[...d[12]||(d[12]=[n("p",null,"Open Config",-1)])]),_:1})]),_:2},1024)]),_:2},1024),e(u)("peek-config-search-matches-dialog-"+g.id)?(i(),V(wt,{key:0,record:g,editId:g.id,searchString:e(k).search_string},null,8,["record","editId","searchString"])):j("",!0),e(u)("peek-config-dialog-"+g.id)?(i(),V(ut,{key:1,editId:g.id},null,8,["editId"])):j("",!0)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),!e(h)&&e(l).length===0?(i(),D("div",Rt,[Object.keys(e(o)).length===0?(i(),D("div",Dt,"No results found.")):j("",!0),Object.keys(e(o)).length?(i(),D("div",Vt,[(i(!0),D(E,null,q(e(o),g=>(i(),D("span",{key:g,class:"col-span-3 col-start-2 text-sm text-red-400"},[d[13]||(d[13]=n("br",null,null,-1)),f(" "+R(g[0]),1)]))),128))])):j("",!0)])):j("",!0),!e(h)&&e(l).length>0?(i(),V(ke,{key:1,currentPage:e(x),lastPage:e(b),perPage:e(a),"onUpdate:currentPage":d[0]||(d[0]=g=>x.value=g),"onUpdate:perPage":d[1]||(d[1]=g=>a.value=g),totalRecords:e(l).total,isLoading:e(h)},null,8,["currentPage","lastPage","perPage","totalRecords","isLoading"])):j("",!0),!e(h)&&e(x)>=e(b)?(i(),D("div",It,[...d[14]||(d[14]=[n("hr",{class:"flex-grow mx-8"},null,-1),n("div",{class:"text-muted-foreground"},"No more results to load.",-1),n("hr",{class:"flex-grow mx-8"},null,-1)])])):j("",!0)])}}};function Mt(v){const c=p({device_name:"",command:"",device_category:"",search_string:"",lines_before:5,lines_after:5,latest_version_only:p(!0),ignore_case:p(!0),start_date:"",end_date:""}),x=p(null),o=p([]);W(()=>{y()});function y(){X.get("/api/configs/distinct-commands/0").then(m=>{o.value=m.data.data}).catch(m=>{createNotification({type:"danger",message:m.response.data.message})})}function u(){c.value.device_name="",c.value.command="",c.value.device_category="",c.value.search_string="",c.value.lines_before=5,c.value.lines_after=5,c.value.latest_version_only=p(!0),c.value.ignore_case=p(!0),c.value.start_date="",c.value.end_date="",v("searchCompleted",c.value)}function h(m){if(m.start&&m.end){const a=`${m.start.year}-${String(m.start.month).padStart(2,"0")}-${String(m.start.day).padStart(2,"0")}`,l=`${m.end.year}-${String(m.end.month).padStart(2,"0")}-${String(m.end.day).padStart(2,"0")}`;c.start_date=a,c.end_date=l}else c.start_date="",c.end_date="";x.value=m}function b(){v("searchCompleted",c.value)}return{clearAll:u,commands:o,model:c,performSearch:b,setDates:h}}const jt={key:0,class:"space-y-2"},Ot={key:0,class:"grid gap-3"},Tt={class:"grid items-center"},zt={class:"grid items-center"},Ft={class:"grid items-center"},Bt={class:"grid items-center"},Nt={class:"flex items-center mt-4 space-x-4"},Ut={class:"flex items-center mb-4 space-x-4"},At={class:"grid grid-cols-1 gap-4 mb-4 md:grid-cols-2"},Et={class:"flex flex-col items-start"},qt={class:"flex flex-col items-start"},Ht={class:"flex flex-col items-start w-full space-x-2"},Kt={__name:"ConfigSearchFilterCard",props:{isLoading:Boolean},emits:["searchCompleted"],setup(v,{emit:c}){const x=c,{clearAll:o,commands:y,model:u,performSearch:h,setDates:b}=Mt(x);return(m,a)=>(i(),D("div",null,[t(e(Ke),{class:"m-2 overflow-hidden"},{default:s(()=>[t(e(Ee),{class:"flex flex-row items-start p-4 bg-muted/50"},{default:s(()=>[...a[11]||(a[11]=[n("div",{class:"grid gap-0.5"},null,-1)])]),_:1}),t(e(qe),{class:"p-4 pt-0 text-sm"},{default:s(()=>[v.isLoading?(i(),D("div",jt,[t(e(A),{class:"w-1/2 h-4"}),t(e(A),{class:"w-full h-4"}),t(e(A),{class:"w-full h-4"}),t(e(A),{class:"w-full h-4"}),t(e(A),{class:"w-full h-4"}),t(e(A),{class:"w-full h-4"}),t(e(A),{class:"w-full h-4"}),t(e(A),{class:"w-full h-4"}),t(e(A),{class:"w-full h-4"})])):j("",!0),t(He,{name:"fade"},{default:s(()=>[v.isLoading?j("",!0):(i(),D("div",Ot,[n("div",Tt,[t(e(Se),{modelValue:e(u).command,"onUpdate:modelValue":a[0]||(a[0]=l=>e(u).command=l)},{default:s(()=>[t(e(Pe),{class:"w-full"},{default:s(()=>[t(e(Re),{class:"placeholder:text-muted-foreground",placeholder:"Select a command"})]),_:1}),t(e(De),{class:"w-full mb-1 focus:outline-none focus-visible:ring-0"},{default:s(()=>[t(e(Ie),null,{default:s(()=>[(i(!0),D(E,null,q(e(y),l=>(i(),V(e(Ve),{value:l.command},{default:s(()=>[f(R(l.command),1)]),_:2},1032,["value"]))),256))]),_:1})]),_:1})]),_:1},8,["modelValue"]),a[12]||(a[12]=n("p",{class:"ml-1 text-xs text-muted-foreground"},[f(" Required "),n("span",{class:"text-red-400"},"*")],-1))]),n("div",zt,[t(e(J),{modelValue:e(u).search_string,"onUpdate:modelValue":a[1]||(a[1]=l=>e(u).search_string=l),id:"search_string",autocomplete:"off",placeholder:"Search String",class:"w-full mt-4 mb-1 focus:outline-none focus-visible:ring-0"},null,8,["modelValue"]),a[13]||(a[13]=n("p",{class:"ml-1 text-xs text-muted-foreground"},[f(" Required "),n("span",{class:"text-red-400"},"*")],-1))]),n("div",Ft,[t(e(J),{modelValue:e(u).device_name,"onUpdate:modelValue":a[2]||(a[2]=l=>e(u).device_name=l),id:"device_name",autocomplete:"off",placeholder:"Device Name",class:"w-full mt-4 mb-1 focus:outline-none focus-visible:ring-0"},null,8,["modelValue"]),a[14]||(a[14]=n("p",{class:"ml-1 text-xs text-muted-foreground"},"Enter full or partial device name",-1))]),n("div",Bt,[t(e(J),{modelValue:e(u).device_category,"onUpdate:modelValue":a[3]||(a[3]=l=>e(u).device_category=l),id:"device_category",autocomplete:"off",placeholder:"Command Group",class:"w-full mt-4 mb-1 focus:outline-none focus-visible:ring-0"},null,8,["modelValue"]),a[15]||(a[15]=n("p",{class:"ml-1 text-xs text-muted-foreground"},"Enter full or partial command group name",-1))]),n("div",Nt,[t(e(ne),{id:"ignore_case",checked:e(u).ignore_case,"onUpdate:checked":a[4]||(a[4]=l=>e(u).ignore_case=l)},null,8,["checked"]),a[16]||(a[16]=n("label",{for:"ignore_case",class:"text-sm font-medium leading-none cursor-pointer peer-disabled:cursor-not-allowed peer-disabled:opacity-70"}," Ignore Case ",-1))]),n("div",Ut,[t(e(ne),{id:"latest_version_only",checked:e(u).latest_version_only,"onUpdate:checked":a[5]||(a[5]=l=>e(u).latest_version_only=l)},null,8,["checked"]),a[17]||(a[17]=n("label",{for:"latest_version_only",class:"text-sm font-medium leading-none cursor-pointer peer-disabled:cursor-not-allowed peer-disabled:opacity-70"}," Latest Version Only ",-1))]),n("div",At,[n("div",Et,[t(e(J),{type:"number",id:"lines_before",modelValue:e(u).lines_before,"onUpdate:modelValue":a[6]||(a[6]=l=>e(u).lines_before=l)},null,8,["modelValue"]),t(e(oe),{for:"lines_before",class:"mt-2 text-sm font-medium leading-none cursor-pointer peer-disabled:cursor-not-allowed peer-disabled:opacity-70"},{default:s(()=>[...a[18]||(a[18]=[f(" Lines Before ",-1)])]),_:1})]),n("div",qt,[t(e(J),{type:"number",id:"lines_after",modelValue:e(u).lines_after,"onUpdate:modelValue":a[7]||(a[7]=l=>e(u).lines_after=l)},null,8,["modelValue"]),t(e(oe),{for:"lines_after",class:"mt-2 text-sm font-medium leading-none cursor-pointer peer-disabled:cursor-not-allowed peer-disabled:opacity-70"},{default:s(()=>[...a[19]||(a[19]=[f(" Lines After ",-1)])]),_:1})])]),n("div",Ht,[t(ct,{class:"w-full",onDateChange:a[8]||(a[8]=l=>e(b)(l))}),a[20]||(a[20]=n("p",{class:"ml-1 text-xs text-muted-foreground"},"Set date range. Last 7 days by default",-1))])]))]),_:1})]),_:1}),t(e(pt),{class:"flex flex-row items-center justify-end px-4 py-2 border-t bg-muted/50"},{default:s(()=>[v.isLoading?j("",!0):(i(),V(e(Q),{key:0,variant:"outline",onClick:a[9]||(a[9]=l=>e(o)()),class:"flex items-center h-6 px-2 py-1 ml-2 text-xs text-muted-foreground"},{default:s(()=>[...a[21]||(a[21]=[f(" Clear ",-1)])]),_:1})),v.isLoading?j("",!0):(i(),V(e(Q),{key:1,variant:"primary",onClick:a[10]||(a[10]=l=>e(h)()),class:"h-6 px-2 py-1 ml-2 text-xs bg-blue-600 hover:bg-blue-700 hover:animate-pulse"},{default:s(()=>[...a[22]||(a[22]=[f(" Search ",-1)])]),_:1}))]),_:1})]),_:1})]))}},Gt={class:"w-screen h-[calc(100vh-72px)] border",style:{display:"flex","flex-direction":"column","background-color":"rgb(27, 29, 33)","border-radius":"16px",margin:"4px 8px 8px","max-width":"calc(100% - 16px)",overflow:"hidden"}},Jt={class:"flex justify-between w-full p-2 border-b"},Xt={class:"flex items-center justify-between p-2 mb-4 border-b"},Qt={class:"flex items-center justify-between p-2 mb-2 border-b"},Wt={__name:"ConfigSearch",setup(v){const c=p({}),x=pe(),o=p(null),y=p(!1),u=a=>{c.value={...a}},h=()=>{x.go(-1)};function b(){o!=null&&o.value.isCollapsed?o==null||o.value.expand():o==null||o.value.collapse(),y.value=!y.value}function m(){o!=null&&o.value.isCollapsed?o==null||o.value.expand():o==null||o.value.collapse(),y.value=!y.value}return(a,l)=>{const k=B("Button"),L=B("ResizablePanel"),M=B("ResizableHandle"),d=B("ResizablePanelGroup");return i(),D("div",Gt,[n("div",Jt,[t(k,{onClick:l[0]||(l[0]=P=>h()),size:"sm",variant:"outline",class:"gap-1 border-none hover:bg-rcgray-800"},{default:s(()=>[t(e(Ge),{size:"16",class:"text-muted-foreground hover:animate-pulse"})]),_:1}),l[3]||(l[3]=n("h2",{class:"items-center content-center text-muted-foreground"},"Config Search",-1)),l[4]||(l[4]=n("div",{class:"flex justify-end"},null,-1))]),t(d,{direction:"horizontal",class:""},{default:s(()=>[t(L,{"default-size":25,"max-size":30,"min-size":10,collapsible:"","collapsed-size":0,ref_key:"panelElement4",ref:o,class:"h-[86vh]"},{default:s(()=>[n("div",Xt,[l[5]||(l[5]=n("h1",{class:"ml-4 text-sm font-semibold"},"Search Options",-1)),t(Je,{class:"mr-2",onClose:l[1]||(l[1]=P=>b())})]),t(Kt,{onSearchCompleted:u})]),_:1},512),t(M,{"with-handle":""}),t(L,{class:"h-[86vh]"},{default:s(()=>[t(e(Xe),{class:"border border-none rounded-md"},{default:s(()=>[n("div",null,[n("div",Qt,[t(Qe,{class:"ml-2",onOpenNav:l[2]||(l[2]=P=>m()),navPanelBtnState:y.value},null,8,["navPanelBtnState"]),n("h1",{class:ce(["w-full text-sm font-semibold",y.value===!1?"ml-2 ":""])}," Results ",2)]),t(Lt,{filters:c.value},null,8,["filters"])])]),_:1})]),_:1})]),_:1})])}}},Yt={class:"relative"},Zt={key:0,class:"flex items-center justify-center py-12"},es={key:1,class:"max-h-[70vh] overflow-y-auto"},ts=["innerHTML"],ss={__name:"ReportViewModal",props:{report_id:{type:[String,Number],required:!0},isOpen:{type:Boolean,default:!1}},emits:["update:isOpen"],setup(v,{emit:c}){const x=v,o=c,{toastError:y}=_e(),u=p(""),h=p(!0);K(()=>x.isOpen,a=>{a&&b()}),W(()=>{x.isOpen&&b()});function b(){h.value=!0,axios.get(`/api/reports/${x.report_id}`).then(a=>{const l=a.data.match(/<body[^>]*>([\s\S]*?)<\/body>/i);u.value=l?l[0]:a.data,h.value=!1}).catch(a=>{var l,k;u.value='<h1 class="text-center text-red-600">Error: File not Found!</h1>',h.value=!1,y("Error","Failed to load report",{description:((k=(l=a.response)==null?void 0:l.data)==null?void 0:k.message)||"An error occurred while loading the report."})})}function m(){o("update:isOpen",!1)}return(a,l)=>{const k=B("Button");return i(),V(e(me),{open:v.isOpen,"onUpdate:open":m},{default:s(()=>[t(e(ie),{class:"w-full max-w-5xl"},{default:s(()=>[t(e(Ce),null,{default:s(()=>[t(e(de),null,{default:s(()=>[...l[0]||(l[0]=[f("Report Viewer",-1)])]),_:1}),h.value?j("",!0):(i(),V(e(ue),{key:0,class:"text-sm text-muted-foreground"},{default:s(()=>[f(" Viewing report ID: "+R(v.report_id),1)]),_:1}))]),_:1}),n("div",Yt,[h.value?(i(),D("div",Zt,[t(e(We),{class:"w-8 h-8 animate-spin text-primary"})])):(i(),D("div",es,[n("div",{innerHTML:u.value},null,8,ts)]))]),t(e(fe),null,{default:s(()=>[t(k,{variant:"outline",onClick:m},{default:s(()=>[...l[1]||(l[1]=[f("Close",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])}}},as=ge(ss,[["__scopeId","data-v-449c7c54"]]);function ls(){const v=p(1),c=xe(),x=p(c.get("useConfigReportsTable","perPage",10)),o=p("-id"),y=p(""),u=p({}),h=p([]),b=p(!1),m=p(1),a=p(0),l=p(0),k=p(1),L=p(!1),M=p(!1),d=p(null),P=le(),{openDialog:g}=P,{toastSuccess:I,toastError:w}=_e(),{reload:$}=lt(C),{toggleSort:N}=at(o,C,"useConfigReportsTable");async function C(O={}){b.value=!0;try{const F=await X.get("/api/reports",{params:{page:v.value,perPage:x.value,sort:o.value,...u.value}});h.value=F.data,m.value=F.data.last_page,a.value=F.data.total}catch(F){console.error("Error fetching reports:",F),w("Error","Failed to fetch reports.")}finally{b.value=!1}}function r(O){d.value=O,M.value=!0}const S=async O=>{try{await X.delete(`/api/reports/${O}`),C(),I("Report Deleted","The report has been deleted successfully."),L.value=!1}catch(F){F.status===422?w("Error",F.response.data.message):(console.error("Error deleting Report:",F),w("Error","Failed to delete Report."))}},U=async O=>{try{await X.post("/api/reports/delete-many",{ids:O}),C(),I("Reports Deleted","The reports have been deleted successfully."),L.value=!1,we.emit("deleteManyReportsSuccess")}catch(F){F.status===422?w("Error",F.response.data.message):(console.error("Error deleting Reports:",F),w("Error","Failed to delete Reports.")),L.value=!1}},H=O=>{l.value=O,k.value=Math.random(),g("DialogNewReport")};function G(O){O.altKey&&O.key==="n"&&(O.preventDefault(),g("DialogNewReport"))}const _=Ye(()=>{u.value["filter[q]"]=y.value,v.value=1,C()},500);return K(v,()=>{C()}),K(y,()=>{_()}),K(x,()=>{c.set("useConfigReportsTable","perPage",x.value),C()}),W(()=>{C(),window.addEventListener("keydown",G)}),re(()=>{window.removeEventListener("keydown",G)}),{reports:h,isLoading:b,currentPage:v,perPage:x,lastPage:m,totalRecords:a,searchTerm:y,showConfirmDelete:L,reload:$,sortParam:o,isReportViewModalOpen:M,currentReportId:d,deleteReport:S,deleteManyReports:U,viewEditDialog:H,toggleSort:N,openReportViewModal:r}}const ns={class:"flex flex-col h-full gap-1 text-center"},os={class:"flex items-center justify-between p-4"},rs={class:"flex items-center"},is={class:"flex items-center justify-end"},ds={class:"px-6"},us={class:"border-b"},cs={__name:"ConfigReportsTable",setup(v){const{reports:c,isLoading:x,currentPage:o,perPage:y,lastPage:u,totalRecords:h,searchTerm:b,showConfirmDelete:m,reload:a,sortParam:l,isReportViewModalOpen:k,currentReportId:L,deleteReport:M,deleteManyReports:d,toggleSort:P,openReportViewModal:g}=ls(),{selectedRows:I,selectAll:w,toggleSelectAll:$,toggleSelectRow:N}=dt(c);return W(()=>{we.on("deleteManyReportsSuccess",()=>{I.value=[],w.value=!1})}),(C,r)=>{const S=B("Input"),U=B("Button"),H=B("RcIcon"),G=B("Checkbox");return i(),D("div",ns,[n("div",os,[n("div",rs,[t(S,{class:"max-w-sm ml-4 mr-2",autocomplete:"off","data-1p-ignore":"","data-lpignore":"true",placeholder:"Filter reports",modelValue:e(b),"onUpdate:modelValue":r[0]||(r[0]=_=>ae(b)?b.value=_:null)},null,8,["modelValue"]),e(b)?(i(),V(nt,{key:0,"onUpdate:modelValue":r[1]||(r[1]=_=>b.value="")})):j("",!0)]),n("div",is,[e(I).length?(i(),V(U,{key:0,class:"px-2 py-1 bg-red-600 hover:bg-red-700 hover:animate-pulse",size:"md",onClick:r[2]||(r[2]=ve(_=>m.value=!0,["prevent"])),variant:"primary"},{default:s(()=>[f("Delete Selected "+R(e(I).length)+" Report(s) ",1)]),_:1})):j("",!0),t(H,{name:"refresh",class:"w-4 h-4 mx-4 text-muted-foreground cursor-pointer hover:text-rcgray-200",onClick:r[3]||(r[3]=_=>e(a)())})])]),n("div",ds,[t(e($e),null,{default:s(()=>[t(e(ye),null,{default:s(()=>[t(e(se),null,{default:s(()=>[t(e(T),{class:"w-[2%]"},{default:s(()=>[t(G,{id:"selectAll",modelValue:e(w),"onUpdate:modelValue":r[4]||(r[4]=_=>ae(w)?w.value=_:null),checked:e(w),onClick:r[5]||(r[5]=_=>e($)())},null,8,["modelValue","checked"])]),_:1}),t(e(T),{class:"w-[5%]"},{default:s(()=>[t(U,{class:"flex justify-start w-full p-0 hover:bg-rcgray-800",variant:"ghost",onClick:r[6]||(r[6]=_=>e(P)("id"))},{default:s(()=>[t(H,{name:"sort",sortParam:e(l),field:"id"},null,8,["sortParam"]),r[14]||(r[14]=n("span",{class:"ml-2"},"ID",-1))]),_:1})]),_:1}),t(e(T),{class:"w-[20%]"},{default:s(()=>[t(U,{class:"flex justify-start w-full p-0 hover:bg-rcgray-800",variant:"ghost",onClick:r[7]||(r[7]=_=>e(P)("report_name"))},{default:s(()=>[t(H,{name:"sort",sortParam:e(l),field:"report_name"},null,8,["sortParam"]),r[15]||(r[15]=n("span",{class:"ml-2"},"Name",-1))]),_:1})]),_:1}),t(e(T),{class:"w-[10%]"},{default:s(()=>[...r[16]||(r[16]=[f("Task ID",-1)])]),_:1}),t(e(T),{class:"w-[10%]"},{default:s(()=>[...r[17]||(r[17]=[f("Task Name",-1)])]),_:1}),t(e(T),{class:"w-[10%]"},{default:s(()=>[t(U,{class:"flex justify-start w-full p-0 hover:bg-rcgray-800",variant:"ghost",onClick:r[8]||(r[8]=_=>e(P)("created_at"))},{default:s(()=>[t(H,{name:"sort",sortParam:e(l),field:"created_at"},null,8,["sortParam"]),r[18]||(r[18]=n("span",{class:"ml-2"},"Created",-1))]),_:1})]),_:1}),t(e(T),{class:"w-[10%]"},{default:s(()=>[...r[19]||(r[19]=[f("Actions",-1)])]),_:1})]),_:1})]),_:1}),t(e(be),null,{default:s(()=>[e(x)?(i(),V(he,{key:0})):e(x)?(i(),V(rt,{key:2})):(i(!0),D(E,{key:1},q(e(c).data,_=>(i(),V(e(se),{key:_.id},{default:s(()=>[t(e(z),{class:"text-start"},{default:s(()=>[t(G,{class:"cursor-pointer",id:"select-"+_.id,checked:!!e(I).includes(_.id),onClick:O=>e(N)(_.id)},null,8,["id","checked","onClick"])]),_:2},1024),t(e(z),{class:"text-start"},{default:s(()=>[f(R(_.id),1)]),_:2},1024),t(e(z),{class:"text-start"},{default:s(()=>[t(U,{class:"px-2 py-0 hover:bg-rcgray-800 rounded-xl",variant:"ghost",onClick:O=>e(g)(_.report_id)},{default:s(()=>[n("span",us,R(_.report_name),1)]),_:2},1032,["onClick"])]),_:2},1024),t(e(z),{class:"text-start"},{default:s(()=>[f(R(_.task_id),1)]),_:2},1024),t(e(z),{class:"text-start"},{default:s(()=>[f(R(_.task_name),1)]),_:2},1024),t(e(z),{class:"text-start"},{default:s(()=>[f(R(_.created_at),1)]),_:2},1024),t(e(z),{class:"text-start"},{default:s(()=>[t(ot,{showEditBtn:!1,rowData:_,onOnDelete:O=>e(M)(_.id)},null,8,["rowData","onOnDelete"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),t(ke,{currentPage:e(o),lastPage:e(u),perPage:e(y),"onUpdate:currentPage":r[9]||(r[9]=_=>o.value=_),"onUpdate:perPage":r[10]||(r[10]=_=>y.value=_),totalRecords:e(h),isLoading:e(x)},null,8,["currentPage","lastPage","perPage","totalRecords","isLoading"]),t(it,{ids:e(I),showConfirmDelete:e(m),onClose:r[11]||(r[11]=_=>m.value=!1),onHandleDelete:r[12]||(r[12]=_=>e(d)(e(I)))},null,8,["ids","showConfirmDelete"]),e(L)?(i(),V(as,{key:0,report_id:e(L),isOpen:e(k),"onUpdate:isOpen":r[13]||(r[13]=_=>k.value=_)},null,8,["report_id","isOpen"])):j("",!0)])])}}},fs={class:"flex flex-col flex-1 gap-2 dark:bg-rcgray-900"},ms={class:"flex flex-row items-center justify-between h-12 gap-3 px-5 border-t border-b"},ps={class:"flex justify-start items-center"},gs=["onClick"],_s={class:"text-2xl text-muted-foreground"},vs={__name:"Main",setup(v){const{configsId:c,statusIdParam:x,currentView:o,viewItems:y,navPillsItems:u,handleNavSelection:h,toggleFavorite:b}=Ze();return(m,a)=>{const l=B("RcIcon");return i(),D("main",fs,[n("div",ms,[n("div",ps,[t(ft,{items:e(u),modelValue:e(o),"onUpdate:modelValue":a[0]||(a[0]=k=>ae(o)?o.value=k:null),"persist-key":"inventorySelectedView",onSelect:e(h)},null,8,["items","modelValue","onSelect"])]),t(e(Y),null,{default:s(()=>[(i(!0),D(E,null,q(e(y),k=>(i(),V(e(Z),{key:k.id},{default:s(()=>[e(o)===k.id?(i(),V(e(ee),{key:0,"as-child":""},{default:s(()=>[n("div",{onClick:ve(L=>e(b)(k.id),["stop","prevent"]),class:"cursor-pointer"},[t(l,{name:k.isFavorite.value?"star-selected":"star-unselected"},null,8,["name"])],8,gs)]),_:2},1024)):j("",!0),t(e(te),null,{default:s(()=>[n("p",null,R(k.isFavorite.value?"Remove from favorites":"Add "+e(o)+" to favorites"),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),n("div",null,[(i(),V(st,null,[(i(),V(et(e(o)==="configs"?mt:e(o)==="configsearch"?Wt:e(o)==="configreport"?cs:null),{configsId:e(c),statusId:e(x),key:e(o)},tt({_:2},[["configsearch","configreport"].includes(e(o))?{name:"default",fn:s(()=>[n("h1",_s,R(e(o)==="configsearch"?"Config Search":e(o)==="configreport"?"Config Reports":""),1)]),key:"0"}:void 0]),1032,["configsId","statusId"]))],1024))])])}}},Ds=ge(vs,[["__scopeId","data-v-5ee0041a"]]);export{Ds as default};
