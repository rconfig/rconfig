import{x as p,D as te,E as se,F as Pe,G as J,g as Re,H as le,r as M,I as De,e as D,o as u,w as s,b as t,u as e,J as Ve,l as Ie,K as oe,a as l,L as ne,M as re,d as _,t as R,N as ie,c as S,O as A,P as E,Q as Le,A as Me,n as de,R as ue,S as ce,T as je,U as fe,V as Oe,z as K,W as G,s as O,p as Q,j as X,k as W,m as Y,X as Be,Y as Te,Z as ze,$ as ae,a0 as Fe,a1 as Ue,a2 as Ne,a3 as Ae,_ as me,a4 as Ee,a5 as ee,a6 as pe,a7 as He,v as qe,a8 as Ke,a9 as Ge}from"./app-CTnbTVu7.js";import{_ as ge,a as Z,b as T,c as _e,d as ve,e as z,f as xe,g as ye,u as Je,h as Qe,i as Xe,j as he,k as We,l as Ye,m as Ze,n as et,o as tt}from"./useRowSelection-C4r9HkZx.js";import{_ as st,a as at,b as lt,C as ot}from"./NavPills-Bzoi_Lwk.js";import{_ as be,a as $e,b as ke,c as we,d as Ce}from"./SelectScrollDownButton-oh7tm0sb.js";import{_ as Se}from"./SelectGroup-80Z-qD3N.js";import{_ as nt}from"./CardFooter.vue_vue_type_script_setup_true_lang-CmPmNXVX.js";import{X as rt}from"./x-_vYIiVBX.js";import{L as it}from"./loader-circle-CKQEUk8_.js";/* empty css               */import"./useCopy-xiB0d9Td.js";import"./square-terminal-CEC8W2eV.js";import"./search-D9IcX3FH.js";import"./square-Cn3KH7HS.js";import"./calendar-ZZHYL4Ld.js";import"./RcToolTip.vue_vue_type_script_setup_true_lang-DfsijFcA.js";import"./BadgeList-BN4rTZr0.js";import"./HoverCardTrigger-DPDQIgB6.js";import"./package-check-vfySVTQR.js";const dt={class:"flex justify-between"},ut={class:"flex items-center"},ct={class:"flex items-center"},ft={class:"grid gap-4 px-6 py-4 overflow-y-auto"},mt={class:"flex flex-col justify-between"},pt={key:1,class:"space-y-4"},gt={class:"mb-2"},_t={class:"text-sm font-medium rc-text-sm-muted underline"},vt=["innerHTML"],xt={__name:"PeekConfigSearchMatchesDialog",props:{editId:{type:Number,required:!0},record:{type:Object,required:!0},searchString:{type:String,required:!0}},setup(b){p({});const m=te(),k=p({}),o=p(!0),$=p(localStorage.getItem("selectedLanguage")||"language-plaintext"),{closeDialog:c,isDialogOpen:w}=m;se();const{copy:y,copied:g}=Pe(),a=b,{matches:i}=a.record,v=["bash","c","cpp","css","html","java","javascript","language-plaintext","php","python","typescript"];J(()=>{window.addEventListener("keydown",I),o.value=!1});const P=h=>{if(!a.searchString||!h)return h;const n=Array.isArray(h)?h.join(`
`):String(h),C=a.searchString.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),j=new RegExp(`(${C})`,"gi");return n.replace(j,'<span class="highlightMatch">$1</span>').replace(/\n/g,"<br>")};function I(h){h.key==="Escape"&&L()}const d=Re(()=>a.record.file);le(()=>{window.removeEventListener("keydown",I)});const F=h=>{k.value[h]=!0},f=h=>{k.value[h]=!1};function L(){c("peek-config-search-matches-dialog-"+a.editId)}return(h,n)=>{const C=M("RcIcon"),j=M("Button"),r=De("highlightjs");return u(),D(e(ce),{open:e(w)("peek-config-search-matches-dialog-"+b.editId)},{default:s(()=>[t(e(Ve),{"as-child":""},{default:s(()=>[Ie(h.$slots,"default")]),_:3}),t(e(oe),{class:"sm:max-w-[70dvw] grid-rows-[auto_minmax(0,1fr)_auto] p-0 max-h-[90dvh]",onEscapeKeyDown:n[5]||(n[5]=V=>e(c)("peek-config-search-matches-dialog-"+b.editId)),onPointerDownOutside:n[6]||(n[6]=V=>e(c)("peek-config-search-matches-dialog-"+b.editId)),onCloseClicked:n[7]||(n[7]=V=>e(c)("peek-config-search-matches-dialog-"+b.editId))},{default:s(()=>[t(e(ne),{class:"p-6 pb-0"},{default:s(()=>[t(e(re),null,{default:s(()=>[_("Configuration Quick Peek (Config ID: "+R(b.editId)+")",1)]),_:1}),t(e(ie),null,{default:s(()=>[l("div",dt,[l("div",ut,[n[8]||(n[8]=l("div",{class:"mr-2"},"Language Options:",-1)),t(e(be),{modelValue:$.value,"onUpdate:modelValue":n[0]||(n[0]=V=>$.value=V)},{default:s(()=>[t(e($e),{class:"w-[180px]"},{default:s(()=>[t(e(ke),{placeholder:"Select a language"})]),_:1}),t(e(we),null,{default:s(()=>[t(e(Se),null,{default:s(()=>[(u(),S(A,null,E(v,V=>t(e(Ce),{value:V,key:V},{default:s(()=>[_(R(V),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),l("div",ct,[_(" Path: "+R(d.value)+" ",1),l("span",{class:"ml-2 cursor-pointer",onMouseover:n[1]||(n[1]=V=>F("fileLocation")),onMouseleave:n[2]||(n[2]=V=>f("fileLocation")),onClick:n[3]||(n[3]=V=>e(y)(d.value))},[t(C,{name:"copy-transition",isActive:e(g),size:16},null,8,["isActive"])],32)])])]),_:1})]),_:1}),l("div",ft,[l("div",mt,[o.value?(u(),D(Le,{key:0})):(u(),S("div",pt,[(u(!0),S(A,null,E(e(i),(V,N)=>(u(),S("div",{key:N,class:"context-block border rounded-lg p-4"},[l("div",gt,[l("span",_t," Matched Line: "+R(V.line_number),1)]),Me(l("pre",{class:de([$.value,"whitespace-pre-wrap text-sm p-3 rounded border overflow-x-auto"]),innerHTML:P(V.context)},null,10,vt),[[r]])]))),128))]))])]),t(e(ue),{class:"p-6 pt-0"},{default:s(()=>[t(j,{onClick:n[4]||(n[4]=V=>L()),variant:"outline"},{default:s(()=>[...n[9]||(n[9]=[_(" Close ",-1)])]),_:1})]),_:1})]),_:1})]),_:3},8,["open"])}}};function yt(b){const m=je("formatters"),k=te(),{openDialog:o,closeDialog:$,isDialogOpen:c}=k,w=fe(),y=p(0),g=p([]),a=p(!1),i=p(1),v=p(1),P=p(5),I=p([]),d=Oe({device_name:"",command:"",device_category:"",search_string:"",lines_before:5,lines_after:5,latest_version_only:!0,ignore_case:!0,start_date:"",end_date:""});K(()=>b.filters,C=>{F(C),f()});function F(C){I.value=[],g.value=[],y.value=0,i.value=1,v.value=1,Object.assign(d,C)}const f=async()=>{var C,j;a.value=!0;try{const r=await G.post("/api/configs/search",{device_name:d.device_name,command:d.command,device_category:d.device_category,search_string:d.search_string,lines_before:d.lines_before,lines_after:d.lines_after,latest_version_only:d.latest_version_only,ignore_case:d.ignore_case,start_date:d.start_date+" 00:00:00",end_date:d.end_date+" 23:59:59",page:v.value,per_page:P.value});r.data.data.length&&(I.value=r.data.data,y.value=r.data.current_page,i.value=r.data.last_page)}catch(r){console.log(r),g.value=((j=(C=r.response)==null?void 0:C.data)==null?void 0:j.errors)||[]}finally{a.value=!1}};function L(C){w.push({name:"configsview",params:{id:parseInt(C)},query:{ref:"configsearch"}})}function h(C){P.value=C,f()}function n(C){console.log(C),v.value=C,f()}return{changePage:n,currentPage:y,errors:g,formatters:m,isDialogOpen:c,isFetching:a,lastPage:i,openDialog:o,perPage:P,results:I,searchModel:d,updatePerpage:h,viewDetailsPane:L}}const ht={class:"px-6"},bt={class:"flex items-center border-b"},$t={key:0,class:"flex items-center justify-center my-4"},kt={key:0},wt={key:1},Ct={key:2,class:"flex items-center justify-center pb-8"},St={__name:"ConfigSearchResultsTable",props:{filters:Object},setup(b){const m=b,{changePage:k,currentPage:o,errors:$,formatters:c,isDialogOpen:w,isFetching:y,lastPage:g,openDialog:a,perPage:i,results:v,searchModel:P,updatePerpage:I,viewDetailsPane:d}=yt(m);return(F,f)=>{const L=M("Icon"),h=M("Button");return u(),S("div",ht,[t(e(xe),null,{default:s(()=>[t(e(ge),null,{default:s(()=>[t(e(Z),null,{default:s(()=>[t(e(T),{class:"w-[5%]"},{default:s(()=>[...f[2]||(f[2]=[_("ID",-1)])]),_:1}),t(e(T),{class:"w-[20%]"},{default:s(()=>[...f[3]||(f[3]=[_("Device",-1)])]),_:1}),t(e(T),{class:"w-[10%]"},{default:s(()=>[...f[4]||(f[4]=[_("Command Group",-1)])]),_:1}),t(e(T),{class:"w-[10%]"},{default:s(()=>[...f[5]||(f[5]=[_("Filesize",-1)])]),_:1}),t(e(T),{class:"w-[10%]"},{default:s(()=>[...f[6]||(f[6]=[_("Config date",-1)])]),_:1}),t(e(T),{class:"w-[10%]"},{default:s(()=>[...f[7]||(f[7]=[_("Matches",-1)])]),_:1}),t(e(T),{class:"w-[10%]"},{default:s(()=>[...f[8]||(f[8]=[_("Actions",-1)])]),_:1})]),_:1})]),_:1}),t(e(_e),null,{default:s(()=>[e(y)?(u(),D(ve,{key:0})):(u(!0),S(A,{key:1},E(e(v),n=>(u(),D(e(Z),{key:n.id},{default:s(()=>[t(e(z),{class:"text-start"},{default:s(()=>[_(R(n.id),1)]),_:2},1024),t(e(z),{class:"text-start"},{default:s(()=>[_(R(n.device_name),1)]),_:2},1024),t(e(z),{class:"text-start"},{default:s(()=>[_(R(n.device_category),1)]),_:2},1024),t(e(z),{class:"text-start"},{default:s(()=>[_(R(e(c).formatFileSize(n.config_filesize)),1)]),_:2},1024),t(e(z),{class:"text-start"},{default:s(()=>[_(R(e(c).formatTime(n.config_date)),1)]),_:2},1024),t(e(z),{class:"text-start"},{default:s(()=>[t(e(Q),null,{default:s(()=>[t(e(X),null,{default:s(()=>[t(e(W),{"as-child":""},{default:s(()=>[t(h,{variant:"ghost",onClick:C=>e(a)("peek-config-search-matches-dialog-"+n.id),class:"px-2 py-0 hover:bg-rcgray-800 rounded-xl"},{default:s(()=>[l("span",bt,[t(L,{icon:"charm:eye",class:"mr-2 text-muted-foreground hover:text-blue-500"}),_(" "+R(n.matches.length?n.matches.length:"No")+" match"+R(n.matches.length>1?"es":""),1)])]),_:2},1032,["onClick"])]),_:2},1024),t(e(Y),{class:"text-white bg-rcgray-800"},{default:s(()=>[...f[9]||(f[9]=[l("p",null,"View Matches",-1)])]),_:1})]),_:2},1024)]),_:2},1024)]),_:2},1024),t(e(z),{class:"flex items-center"},{default:s(()=>[t(e(Q),null,{default:s(()=>[t(e(X),null,{default:s(()=>[t(e(W),{"as-child":""},{default:s(()=>[t(h,{variant:"ghost",onClick:C=>e(a)("peek-config-dialog-"+n.id)},{default:s(()=>[t(L,{icon:"lets-icons:view-alt-fill",class:"size-6 text-muted-foreground hover:text-blue-500"})]),_:1},8,["onClick"])]),_:2},1024),t(e(Y),{class:"text-white bg-rcgray-800"},{default:s(()=>[...f[10]||(f[10]=[l("p",null,"Peek Config",-1)])]),_:1})]),_:2},1024)]),_:2},1024),t(e(Q),null,{default:s(()=>[t(e(X),null,{default:s(()=>[t(e(W),{"as-child":""},{default:s(()=>[t(h,{variant:"ghost",onClick:C=>e(d)(n.id)},{default:s(()=>[t(L,{icon:"hugeicons:file-view",class:"size-5 text-muted-foreground hover:text-blue-500"})]),_:1},8,["onClick"])]),_:2},1024),t(e(Y),{class:"text-white bg-rcgray-800"},{default:s(()=>[...f[11]||(f[11]=[l("p",null,"Open Config",-1)])]),_:1})]),_:2},1024)]),_:2},1024),e(w)("peek-config-search-matches-dialog-"+n.id)?(u(),D(xt,{key:0,record:n,editId:n.id,searchString:e(P).search_string},null,8,["record","editId","searchString"])):O("",!0),e(w)("peek-config-dialog-"+n.id)?(u(),D(st,{key:1,editId:n.id},null,8,["editId"])):O("",!0)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),!e(y)&&e(v).length===0?(u(),S("div",$t,[Object.keys(e($)).length===0?(u(),S("div",kt,"No results found.")):O("",!0),Object.keys(e($)).length?(u(),S("div",wt,[(u(!0),S(A,null,E(e($),n=>(u(),S("span",{key:n,class:"col-span-3 col-start-2 text-sm text-red-400"},[f[12]||(f[12]=l("br",null,null,-1)),_(" "+R(n[0]),1)]))),128))])):O("",!0)])):O("",!0),!e(y)&&e(v).length>0?(u(),D(ye,{key:1,currentPage:e(o),lastPage:e(g),perPage:e(i),"onUpdate:currentPage":f[0]||(f[0]=n=>e(k)(n)),"onUpdate:perPage":f[1]||(f[1]=n=>e(I)(n))},null,8,["currentPage","lastPage","perPage"])):O("",!0),!e(y)&&e(o)>=e(g)?(u(),S("div",Ct,[...f[13]||(f[13]=[l("hr",{class:"flex-grow mx-8"},null,-1),l("div",{class:"text-muted-foreground"},"No more results to load.",-1),l("hr",{class:"flex-grow mx-8"},null,-1)])])):O("",!0)])}}};function Pt(b){const m=p({device_name:"",command:"",device_category:"",search_string:"",lines_before:5,lines_after:5,latest_version_only:p(!0),ignore_case:p(!0),start_date:"",end_date:""}),k=p(null),o=p([]);J(()=>{$()});function $(){G.get("/api/configs/distinct-commands/0").then(g=>{o.value=g.data.data}).catch(g=>{createNotification({type:"danger",message:g.response.data.message})})}function c(){m.value.device_name="",m.value.command="",m.value.device_category="",m.value.search_string="",m.value.lines_before=5,m.value.lines_after=5,m.value.latest_version_only=p(!0),m.value.ignore_case=p(!0),m.value.start_date="",m.value.end_date="",b("searchCompleted",m.value)}function w(g){if(g.start&&g.end){const a=`${g.start.year}-${String(g.start.month).padStart(2,"0")}-${String(g.start.day).padStart(2,"0")}`,i=`${g.end.year}-${String(g.end.month).padStart(2,"0")}-${String(g.end.day).padStart(2,"0")}`;m.start_date=a,m.end_date=i}else m.start_date="",m.end_date="";k.value=g}function y(){b("searchCompleted",m.value)}return{clearAll:c,commands:o,model:m,performSearch:y,setDates:w}}const Rt={key:0,class:"space-y-2"},Dt={key:0,class:"grid gap-3"},Vt={class:"grid items-center"},It={class:"grid items-center"},Lt={class:"grid items-center"},Mt={class:"grid items-center"},jt={class:"flex items-center mt-4 space-x-4"},Ot={class:"flex items-center mb-4 space-x-4"},Bt={class:"grid grid-cols-1 gap-4 mb-4 md:grid-cols-2"},Tt={class:"flex flex-col items-start"},zt={class:"flex flex-col items-start"},Ft={class:"flex flex-col items-start w-full space-x-2"},Ut={__name:"ConfigSearchFilterCard",props:{isLoading:Boolean},emits:["searchCompleted"],setup(b,{emit:m}){const k=m,{clearAll:o,commands:$,model:c,performSearch:w,setDates:y}=Pt(k);return(g,a)=>{const i=M("Skeleton"),v=M("Input"),P=M("Label"),I=M("Button");return u(),S("div",null,[t(e(Fe),{class:"m-2 overflow-hidden"},{default:s(()=>[t(e(Be),{class:"flex flex-row items-start p-4 bg-muted/50"},{default:s(()=>[...a[11]||(a[11]=[l("div",{class:"grid gap-0.5"},null,-1)])]),_:1}),t(e(Te),{class:"p-4 pt-0 text-sm"},{default:s(()=>[b.isLoading?(u(),S("div",Rt,[t(i,{class:"w-1/2 h-4"}),t(i,{class:"w-full h-4"}),t(i,{class:"w-full h-4"}),t(i,{class:"w-full h-4"}),t(i,{class:"w-full h-4"}),t(i,{class:"w-full h-4"}),t(i,{class:"w-full h-4"}),t(i,{class:"w-full h-4"}),t(i,{class:"w-full h-4"})])):O("",!0),t(ze,{name:"fade"},{default:s(()=>[b.isLoading?O("",!0):(u(),S("div",Dt,[l("div",Vt,[t(e(be),{modelValue:e(c).command,"onUpdate:modelValue":a[0]||(a[0]=d=>e(c).command=d)},{default:s(()=>[t(e($e),{class:"w-full"},{default:s(()=>[t(e(ke),{class:"placeholder:text-muted-foreground",placeholder:"Select a command"})]),_:1}),t(e(we),{class:"w-full mb-1 focus:outline-none focus-visible:ring-0"},{default:s(()=>[t(e(Se),null,{default:s(()=>[(u(!0),S(A,null,E(e($),d=>(u(),D(e(Ce),{value:d.command},{default:s(()=>[_(R(d.command),1)]),_:2},1032,["value"]))),256))]),_:1})]),_:1})]),_:1},8,["modelValue"]),a[12]||(a[12]=l("p",{class:"ml-1 text-xs text-muted-foreground"},[_(" Required "),l("span",{class:"text-red-400"},"*")],-1))]),l("div",It,[t(v,{modelValue:e(c).search_string,"onUpdate:modelValue":a[1]||(a[1]=d=>e(c).search_string=d),id:"search_string",autocomplete:"off",placeholder:"Search String",class:"w-full mt-4 mb-1 focus:outline-none focus-visible:ring-0"},null,8,["modelValue"]),a[13]||(a[13]=l("p",{class:"ml-1 text-xs text-muted-foreground"},[_(" Required "),l("span",{class:"text-red-400"},"*")],-1))]),l("div",Lt,[t(v,{modelValue:e(c).device_name,"onUpdate:modelValue":a[2]||(a[2]=d=>e(c).device_name=d),id:"device_name",autocomplete:"off",placeholder:"Device Name",class:"w-full mt-4 mb-1 focus:outline-none focus-visible:ring-0"},null,8,["modelValue"]),a[14]||(a[14]=l("p",{class:"ml-1 text-xs text-muted-foreground"},"Enter full or partial device name",-1))]),l("div",Mt,[t(v,{modelValue:e(c).device_category,"onUpdate:modelValue":a[3]||(a[3]=d=>e(c).device_category=d),id:"device_category",autocomplete:"off",placeholder:"Command Group",class:"w-full mt-4 mb-1 focus:outline-none focus-visible:ring-0"},null,8,["modelValue"]),a[15]||(a[15]=l("p",{class:"ml-1 text-xs text-muted-foreground"},"Enter full or partial command group name",-1))]),l("div",jt,[t(e(ae),{id:"ignore_case",checked:e(c).ignore_case,"onUpdate:checked":a[4]||(a[4]=d=>e(c).ignore_case=d)},null,8,["checked"]),a[16]||(a[16]=l("label",{for:"ignore_case",class:"text-sm font-medium leading-none cursor-pointer peer-disabled:cursor-not-allowed peer-disabled:opacity-70"}," Ignore Case ",-1))]),l("div",Ot,[t(e(ae),{id:"latest_version_only",checked:e(c).latest_version_only,"onUpdate:checked":a[5]||(a[5]=d=>e(c).latest_version_only=d)},null,8,["checked"]),a[17]||(a[17]=l("label",{for:"latest_version_only",class:"text-sm font-medium leading-none cursor-pointer peer-disabled:cursor-not-allowed peer-disabled:opacity-70"}," Latest Version Only ",-1))]),l("div",Bt,[l("div",Tt,[t(v,{type:"number",id:"lines_before",modelValue:e(c).lines_before,"onUpdate:modelValue":a[6]||(a[6]=d=>e(c).lines_before=d)},null,8,["modelValue"]),t(P,{for:"lines_before",class:"mt-2 text-sm font-medium leading-none cursor-pointer peer-disabled:cursor-not-allowed peer-disabled:opacity-70"},{default:s(()=>[...a[18]||(a[18]=[_(" Lines Before ",-1)])]),_:1})]),l("div",zt,[t(v,{type:"number",id:"lines_after",modelValue:e(c).lines_after,"onUpdate:modelValue":a[7]||(a[7]=d=>e(c).lines_after=d)},null,8,["modelValue"]),t(P,{for:"lines_after",class:"mt-2 text-sm font-medium leading-none cursor-pointer peer-disabled:cursor-not-allowed peer-disabled:opacity-70"},{default:s(()=>[...a[19]||(a[19]=[_(" Lines After ",-1)])]),_:1})])]),l("div",Ft,[t(at,{class:"w-full",onDateChange:a[8]||(a[8]=d=>e(y)(d))}),a[20]||(a[20]=l("p",{class:"ml-1 text-xs text-muted-foreground"},"Set date range. Last 7 days by default",-1))])]))]),_:1})]),_:1}),t(e(nt),{class:"flex flex-row items-center justify-end px-4 py-2 border-t bg-muted/50"},{default:s(()=>[b.isLoading?O("",!0):(u(),D(I,{key:0,variant:"outline",onClick:a[9]||(a[9]=d=>e(o)()),class:"flex items-center h-6 px-2 py-1 ml-2 text-xs text-muted-foreground"},{default:s(()=>[...a[21]||(a[21]=[_(" Clear ",-1)])]),_:1})),b.isLoading?O("",!0):(u(),D(I,{key:1,variant:"primary",onClick:a[10]||(a[10]=d=>e(w)()),class:"h-6 px-2 py-1 ml-2 text-xs bg-blue-600 hover:bg-blue-700 hover:animate-pulse"},{default:s(()=>[...a[22]||(a[22]=[_(" Search ",-1)])]),_:1}))]),_:1})]),_:1})])}}},Nt={class:"w-screen h-[calc(100vh-72px)] border",style:{display:"flex","flex-direction":"column","background-color":"rgb(27, 29, 33)","border-radius":"16px",margin:"4px 8px 8px","max-width":"calc(100% - 16px)",overflow:"hidden"}},At={class:"flex justify-between w-full p-2 border-b"},Et={class:"flex items-center justify-between p-2 mb-4 border-b"},Ht={class:"flex items-center justify-between p-2 mb-2 border-b"},qt={__name:"ConfigSearch",setup(b){const m=p({}),k=fe(),o=p(null),$=p(!1),c=a=>{m.value={...a}},w=()=>{k.go(-1)};function y(){o!=null&&o.value.isCollapsed?o==null||o.value.expand():o==null||o.value.collapse(),$.value=!$.value}function g(){o!=null&&o.value.isCollapsed?o==null||o.value.expand():o==null||o.value.collapse(),$.value=!$.value}return(a,i)=>{const v=M("Button"),P=M("ResizablePanel"),I=M("ResizableHandle"),d=M("ResizablePanelGroup");return u(),S("div",Nt,[l("div",At,[t(v,{onClick:i[0]||(i[0]=F=>w()),size:"sm",variant:"outline",class:"gap-1 border-none hover:bg-rcgray-800"},{default:s(()=>[t(e(rt),{size:"16",class:"text-muted-foreground hover:animate-pulse"})]),_:1}),i[3]||(i[3]=l("h2",{class:"items-center content-center text-muted-foreground"},"Config Search",-1)),i[4]||(i[4]=l("div",{class:"flex justify-end"},null,-1))]),t(d,{direction:"horizontal",class:""},{default:s(()=>[t(P,{"default-size":25,"max-size":30,"min-size":10,collapsible:"","collapsed-size":0,ref_key:"panelElement4",ref:o,class:"h-[86vh]"},{default:s(()=>[l("div",Et,[i[5]||(i[5]=l("h1",{class:"ml-4 text-sm font-semibold"},"Search Options",-1)),t(Ue,{class:"mr-2",onClose:i[1]||(i[1]=F=>y())})]),t(Ut,{onSearchCompleted:c})]),_:1},512),t(I,{"with-handle":""}),t(P,{class:"h-[86vh]"},{default:s(()=>[t(e(Ne),{class:"border border-none rounded-md"},{default:s(()=>[l("div",null,[l("div",Ht,[t(Ae,{class:"ml-2",onOpenNav:i[2]||(i[2]=F=>g()),navPanelBtnState:$.value},null,8,["navPanelBtnState"]),l("h1",{class:de(["w-full text-sm font-semibold",$.value===!1?"ml-2 ":""])}," Results ",2)]),t(St,{filters:m.value},null,8,["filters"])])]),_:1})]),_:1})]),_:1})])}}},Kt={class:"relative"},Gt={key:0,class:"flex items-center justify-center py-12"},Jt={key:1,class:"max-h-[70vh] overflow-y-auto"},Qt=["innerHTML"],Xt={__name:"ReportViewModal",props:{report_id:{type:[String,Number],required:!0},isOpen:{type:Boolean,default:!1}},emits:["update:isOpen"],setup(b,{emit:m}){const k=b,o=m,{toastError:$}=se(),c=p(""),w=p(!0);K(()=>k.isOpen,a=>{a&&y()}),J(()=>{k.isOpen&&y()});function y(){w.value=!0,axios.get(`/api/reports/${k.report_id}`).then(a=>{const i=a.data.match(/<body[^>]*>([\s\S]*?)<\/body>/i);c.value=i?i[0]:a.data,w.value=!1}).catch(a=>{var i,v;c.value='<h1 class="text-center text-red-600">Error: File not Found!</h1>',w.value=!1,$("Error","Failed to load report",{description:((v=(i=a.response)==null?void 0:i.data)==null?void 0:v.message)||"An error occurred while loading the report."})})}function g(){o("update:isOpen",!1)}return(a,i)=>{const v=M("Button");return u(),D(e(ce),{open:b.isOpen,"onUpdate:open":g},{default:s(()=>[t(e(oe),{class:"w-full max-w-5xl"},{default:s(()=>[t(e(ne),null,{default:s(()=>[t(e(re),null,{default:s(()=>[...i[0]||(i[0]=[_("Report Viewer",-1)])]),_:1}),w.value?O("",!0):(u(),D(e(ie),{key:0,class:"text-sm text-muted-foreground"},{default:s(()=>[_(" Viewing report ID: "+R(b.report_id),1)]),_:1}))]),_:1}),l("div",Kt,[w.value?(u(),S("div",Gt,[t(e(it),{class:"w-8 h-8 animate-spin text-primary"})])):(u(),S("div",Jt,[l("div",{innerHTML:c.value},null,8,Qt)]))]),t(e(ue),null,{default:s(()=>[t(v,{variant:"outline",onClick:g},{default:s(()=>[...i[1]||(i[1]=[_("Close",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])}}},Wt=me(Xt,[["__scopeId","data-v-449c7c54"]]);function Yt(){const b=p(1),m=Je(),k=p(m.get("useConfigReportsTable","perPage",10)),o=p("-id"),$=p(""),c=p({}),w=p([]),y=p(!1),g=p(1),a=p(0),i=p(0),v=p(1),P=p(!1),I=p(!1),d=p(null),F=te(),{openDialog:f}=F,{toastSuccess:L,toastError:h}=se(),{reload:n}=Xe(j),{toggleSort:C}=Qe(o,j,"useConfigReportsTable");async function j(B={}){y.value=!0;try{const U=await G.get("/api/reports",{params:{page:b.value,perPage:k.value,sort:o.value,...c.value}});w.value=U.data,g.value=U.data.last_page,a.value=U.data.total}catch(U){console.error("Error fetching reports:",U),h("Error","Failed to fetch reports.")}finally{y.value=!1}}function r(B){d.value=B,I.value=!0}const V=async B=>{try{await G.delete(`/api/reports/${B}`),j(),L("Report Deleted","The report has been deleted successfully."),P.value=!1}catch(U){U.status===422?h("Error",U.response.data.message):(console.error("Error deleting Report:",U),h("Error","Failed to delete Report."))}},N=async B=>{try{await G.post("/api/reports/delete-many",{ids:B}),j(),L("Reports Deleted","The reports have been deleted successfully."),P.value=!1,he.emit("deleteManyReportsSuccess")}catch(U){U.status===422?h("Error",U.response.data.message):(console.error("Error deleting Reports:",U),h("Error","Failed to delete Reports.")),P.value=!1}},H=B=>{i.value=B,v.value=Math.random(),f("DialogNewReport")};function q(B){B.altKey&&B.key==="n"&&(B.preventDefault(),f("DialogNewReport"))}const x=Ee(()=>{c.value["filter[q]"]=$.value,b.value=1,j()},500);return K(b,()=>{j()}),K($,()=>{x()}),K(k,()=>{m.set("useConfigReportsTable","perPage",k.value),j()}),J(()=>{j(),window.addEventListener("keydown",q)}),le(()=>{window.removeEventListener("keydown",q)}),{reports:w,isLoading:y,currentPage:b,perPage:k,lastPage:g,totalRecords:a,searchTerm:$,showConfirmDelete:P,reload:n,sortParam:o,isReportViewModalOpen:I,currentReportId:d,deleteReport:V,deleteManyReports:N,viewEditDialog:H,toggleSort:C,openReportViewModal:r}}const Zt={class:"flex flex-col h-full gap-1 text-center"},es={class:"flex items-center justify-between p-4"},ts={class:"flex items-center"},ss={class:"flex items-center justify-end"},as={class:"px-6"},ls={class:"border-b"},os={__name:"ConfigReportsTable",setup(b){const{reports:m,isLoading:k,currentPage:o,perPage:$,lastPage:c,totalRecords:w,searchTerm:y,showConfirmDelete:g,reload:a,sortParam:i,isReportViewModalOpen:v,currentReportId:P,deleteReport:I,deleteManyReports:d,toggleSort:F,openReportViewModal:f}=Yt(),{selectedRows:L,selectAll:h,toggleSelectAll:n,toggleSelectRow:C}=We(m);return J(()=>{he.on("deleteManyReportsSuccess",()=>{L.value=[],h.value=!1})}),(j,r)=>{const V=M("Input"),N=M("Button"),H=M("RcIcon"),q=M("Checkbox");return u(),S("div",Zt,[l("div",es,[l("div",ts,[t(V,{class:"max-w-sm ml-4 mr-2",autocomplete:"off","data-1p-ignore":"","data-lpignore":"true",placeholder:"Filter reports",modelValue:e(y),"onUpdate:modelValue":r[0]||(r[0]=x=>ee(y)?y.value=x:null)},null,8,["modelValue"]),e(y)?(u(),D(Ye,{key:0,"onUpdate:modelValue":r[1]||(r[1]=x=>y.value="")})):O("",!0)]),l("div",ss,[e(L).length?(u(),D(N,{key:0,class:"px-2 py-1 bg-red-600 hover:bg-red-700 hover:animate-pulse",size:"md",onClick:r[2]||(r[2]=pe(x=>g.value=!0,["prevent"])),variant:"primary"},{default:s(()=>[_("Delete Selected "+R(e(L).length)+" Report(s) ",1)]),_:1})):O("",!0),t(H,{name:"refresh",class:"w-4 h-4 mx-4 text-muted-foreground cursor-pointer hover:text-rcgray-200",onClick:r[3]||(r[3]=x=>e(a)())})])]),l("div",as,[t(e(xe),null,{default:s(()=>[t(e(ge),null,{default:s(()=>[t(e(Z),null,{default:s(()=>[t(e(T),{class:"w-[2%]"},{default:s(()=>[t(q,{id:"selectAll",modelValue:e(h),"onUpdate:modelValue":r[4]||(r[4]=x=>ee(h)?h.value=x:null),checked:e(h),onClick:r[5]||(r[5]=x=>e(n)())},null,8,["modelValue","checked"])]),_:1}),t(e(T),{class:"w-[5%]"},{default:s(()=>[t(N,{class:"flex justify-start w-full p-0 hover:bg-rcgray-800",variant:"ghost",onClick:r[6]||(r[6]=x=>e(F)("id"))},{default:s(()=>[t(H,{name:"sort",sortParam:e(i),field:"id"},null,8,["sortParam"]),r[14]||(r[14]=l("span",{class:"ml-2"},"ID",-1))]),_:1})]),_:1}),t(e(T),{class:"w-[20%]"},{default:s(()=>[t(N,{class:"flex justify-start w-full p-0 hover:bg-rcgray-800",variant:"ghost",onClick:r[7]||(r[7]=x=>e(F)("report_name"))},{default:s(()=>[t(H,{name:"sort",sortParam:e(i),field:"report_name"},null,8,["sortParam"]),r[15]||(r[15]=l("span",{class:"ml-2"},"Name",-1))]),_:1})]),_:1}),t(e(T),{class:"w-[10%]"},{default:s(()=>[...r[16]||(r[16]=[_("Task ID",-1)])]),_:1}),t(e(T),{class:"w-[10%]"},{default:s(()=>[...r[17]||(r[17]=[_("Task Name",-1)])]),_:1}),t(e(T),{class:"w-[10%]"},{default:s(()=>[t(N,{class:"flex justify-start w-full p-0 hover:bg-rcgray-800",variant:"ghost",onClick:r[8]||(r[8]=x=>e(F)("created_at"))},{default:s(()=>[t(H,{name:"sort",sortParam:e(i),field:"created_at"},null,8,["sortParam"]),r[18]||(r[18]=l("span",{class:"ml-2"},"Created",-1))]),_:1})]),_:1}),t(e(T),{class:"w-[10%]"},{default:s(()=>[...r[19]||(r[19]=[_("Actions",-1)])]),_:1})]),_:1})]),_:1}),t(e(_e),null,{default:s(()=>[e(k)?(u(),D(ve,{key:0})):e(k)?(u(),D(et,{key:2})):(u(!0),S(A,{key:1},E(e(m).data,x=>(u(),D(e(Z),{key:x.id},{default:s(()=>[t(e(z),{class:"text-start"},{default:s(()=>[t(q,{class:"cursor-pointer",id:"select-"+x.id,checked:!!e(L).includes(x.id),onClick:B=>e(C)(x.id)},null,8,["id","checked","onClick"])]),_:2},1024),t(e(z),{class:"text-start"},{default:s(()=>[_(R(x.id),1)]),_:2},1024),t(e(z),{class:"text-start"},{default:s(()=>[t(N,{class:"px-2 py-0 hover:bg-rcgray-800 rounded-xl",variant:"ghost",onClick:B=>e(f)(x.report_id)},{default:s(()=>[l("span",ls,R(x.report_name),1)]),_:2},1032,["onClick"])]),_:2},1024),t(e(z),{class:"text-start"},{default:s(()=>[_(R(x.task_id),1)]),_:2},1024),t(e(z),{class:"text-start"},{default:s(()=>[_(R(x.task_name),1)]),_:2},1024),t(e(z),{class:"text-start"},{default:s(()=>[_(R(x.created_at),1)]),_:2},1024),t(e(z),{class:"text-start"},{default:s(()=>[t(Ze,{showEditBtn:!1,rowData:x,onOnDelete:B=>e(I)(x.id)},null,8,["rowData","onOnDelete"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),t(ye,{currentPage:e(o),lastPage:e(c),perPage:e($),"onUpdate:currentPage":r[9]||(r[9]=x=>o.value=x),"onUpdate:perPage":r[10]||(r[10]=x=>$.value=x),totalRecords:e(w),isLoading:e(k)},null,8,["currentPage","lastPage","perPage","totalRecords","isLoading"]),t(tt,{ids:e(L),showConfirmDelete:e(g),onClose:r[11]||(r[11]=x=>g.value=!1),onHandleDelete:r[12]||(r[12]=x=>e(d)(e(L)))},null,8,["ids","showConfirmDelete"]),e(P)?(u(),D(Wt,{key:0,report_id:e(P),isOpen:e(v),"onUpdate:isOpen":r[13]||(r[13]=x=>v.value=x)},null,8,["report_id","isOpen"])):O("",!0)])])}}},ns={class:"flex flex-col flex-1 gap-2 dark:bg-rcgray-900"},rs={class:"flex flex-row items-center justify-between h-12 gap-3 px-5 border-t border-b"},is={class:"flex justify-start items-center"},ds=["onClick"],us={class:"text-2xl text-muted-foreground"},cs={__name:"Main",setup(b){const{configsId:m,statusIdParam:k,currentView:o,viewItems:$,navPillsItems:c,handleNavSelection:w,toggleFavorite:y}=He();return(g,a)=>{const i=M("RcIcon");return u(),S("main",ns,[l("div",rs,[l("div",is,[t(lt,{items:e(c),modelValue:e(o),"onUpdate:modelValue":a[0]||(a[0]=v=>ee(o)?o.value=v:null),"persist-key":"inventorySelectedView",onSelect:e(w)},null,8,["items","modelValue","onSelect"])]),t(e(Q),null,{default:s(()=>[(u(!0),S(A,null,E(e($),v=>(u(),D(e(X),{key:v.id},{default:s(()=>[e(o)===v.id?(u(),D(e(W),{key:0,"as-child":""},{default:s(()=>[l("div",{onClick:pe(P=>e(y)(v.id),["stop","prevent"]),class:"cursor-pointer"},[t(i,{name:v.isFavorite.value?"star-selected":"star-unselected"},null,8,["name"])],8,ds)]),_:2},1024)):O("",!0),t(e(Y),null,{default:s(()=>[l("p",null,R(v.isFavorite.value?"Remove from favorites":"Add "+e(o)+" to favorites"),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),l("div",null,[(u(),D(Ge,null,[(u(),D(qe(e(o)==="configs"?ot:e(o)==="configsearch"?qt:e(o)==="configreport"?os:null),{configsId:e(m),statusId:e(k),key:e(o)},Ke({_:2},[["configsearch","configreport"].includes(e(o))?{name:"default",fn:s(()=>[l("h1",us,R(e(o)==="configsearch"?"Config Search":e(o)==="configreport"?"Config Reports":""),1)]),key:"0"}:void 0]),1032,["configsId","statusId"]))],1024))])])}}},Vs=me(cs,[["__scopeId","data-v-5ee0041a"]]);export{Vs as default};
