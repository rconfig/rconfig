import{u as H,J as Q,r as g,A as X,a as F,K as Y,T as R,c as b,z as D,o as c,w as l,e as t,f as e,L as ee,M as se,k as o,N as te,O as ae,t as w,d as N,j as $,h as i,R as le,S as oe,U as ne,ac as re,V as J,W as de,F as ie,G as ue}from"./app-xn2RtsP0.js";import{u as ce,_ as me,a as pe,b as W,c as K,d as fe,e as ge,f as j,g as ve,h as _e,i as we,j as ye}from"./useRowSelection-Dw9uXHYU.js";import{_ as xe,a as ke,b as $e,c as be,d as Ue,e as q}from"./SelectScrollDownButton-CQ0m9uge.js";/* empty css               */const Ie={class:"flex items-center"},De={class:"ml-2"},Ve={class:"grid gap-2 p-4"},Pe={class:"grid items-center grid-cols-4 gap-2"},Ce={key:0,class:"col-span-3 col-start-2 text-sm text-red-400"},Se={class:"grid items-center grid-cols-4 gap-2"},Ee={key:0,class:"col-span-3 col-start-2 text-sm text-red-400"},Ne={class:"grid items-center grid-cols-4 gap-2"},he={key:0,class:"col-span-3 col-start-2 text-sm text-red-400"},Le={class:"grid items-center grid-cols-4 gap-2"},Me={key:0,class:"col-span-3 col-start-2 text-sm text-red-400"},Te={class:"grid items-center grid-cols-4 gap-2"},Ae={key:0,class:"col-span-3 col-start-2 text-sm text-red-400"},Ke={key:1,class:"col-span-3 col-start-2 text-sm text-green-400"},je={class:"grid items-center grid-cols-4 gap-4"},Be={class:"pl-2 ml-auto"},Re={class:"rc-kdb-class2"},Fe={class:"pl-2 ml-auto"},Oe={class:"rc-kdb-class2"},ze={__name:"UserAddEditDialog",props:{editId:Number},emits:["save"],setup(v,{emit:V}){const{toastSuccess:k}=H(),P=Q(),{openDialog:L,closeDialog:_,isDialogOpen:C}=P,S=V;g([]);const u=g([]),n=g({name:"",username:"",email:"",password:"",repeat_password:"",role:""}),U=g(""),f=v;function M(m){m.ctrlKey&&m.key==="Enter"&&I()}X(()=>{f.editId>0&&F.get(`/api/users/${f.editId}`).then(m=>{n.value=m.data}),window.addEventListener("keydown",M)}),Y(()=>{window.removeEventListener("keydown",M)}),R(()=>[n.value.password,n.value.repeat_password],()=>{n.value.password!==n.value.repeat_password?(U.value="",u.value.repeat_password=["Passwords do not match"]):(delete u.value.repeat_password,U.value="Passwords match")});function I(){let m=f.editId>0?`/${f.editId}`:"",s=f.editId>0?"patch":"post";F[s]("/api/users"+m,n.value).then(p=>{S("save",p.data),k("User created","The user has been created successfully."),_("DialogNewUser")}).catch(p=>{u.value=p.response.data.errors})}return(m,s)=>{const p=b("UserIcon"),y=b("Label"),x=b("Input"),h=b("Button"),T=b("Icon");return c(),D(e(oe),{open:e(C)("DialogNewUser")},{default:l(()=>[t(e(ee),{"as-child":""}),t(e(se),{class:"p-0 sm:max-w-fit",onEscapeKeyDown:s[9]||(s[9]=d=>e(_)("DialogNewUser")),onPointerDownOutside:s[10]||(s[10]=d=>e(_)("DialogNewUser")),onCloseClicked:s[11]||(s[11]=d=>e(_)("DialogNewUser"))},{default:l(()=>[t(e(te),{class:"rc-dialog-header"},{default:l(()=>[t(e(ae),{class:"text-sm text-rcgray-200"},{default:l(()=>[o("div",Ie,[t(p),o("span",De,w(v.editId>0?"Edit":"Add")+" User "+w(v.editId>0?"(ID: "+v.editId+")":""),1)])]),_:1})]),_:1}),o("div",Ve,[o("div",Pe,[t(y,{for:"name",class:"text-right"},{default:l(()=>[...s[12]||(s[12]=[i(" Name ",-1),o("span",{class:"text-red-400"},"*",-1)])]),_:1}),t(x,{modelValue:n.value.name,"onUpdate:modelValue":s[0]||(s[0]=d=>n.value.name=d),id:"name",class:"col-span-3",autocomplete:"off"},null,8,["modelValue"]),u.value.name?(c(),N("span",Ce,w(u.value.name[0]),1)):$("",!0)]),o("div",Se,[t(y,{for:"username",class:"text-right"},{default:l(()=>[...s[13]||(s[13]=[i(" User Name ",-1)])]),_:1}),t(x,{modelValue:n.value.username,"onUpdate:modelValue":s[1]||(s[1]=d=>n.value.username=d),id:"username",class:"col-span-3"},null,8,["modelValue"]),u.value.username?(c(),N("span",Ee,w(u.value.username[0]),1)):$("",!0)]),o("div",Ne,[t(y,{for:"email",class:"text-right"},{default:l(()=>[...s[14]||(s[14]=[i(" Email ",-1),o("span",{class:"text-red-400"},"*",-1)])]),_:1}),t(x,{modelValue:n.value.email,"onUpdate:modelValue":s[2]||(s[2]=d=>n.value.email=d),id:"email",type:"email",class:"col-span-3"},null,8,["modelValue"]),u.value.email?(c(),N("span",he,w(u.value.email[0]),1)):$("",!0)]),o("div",Le,[t(y,{for:"password",class:"text-right"},{default:l(()=>[...s[15]||(s[15]=[i(" Password ",-1),o("span",{class:"text-red-400"},"*",-1)])]),_:1}),t(x,{type:"password",modelValue:n.value.password,"onUpdate:modelValue":s[3]||(s[3]=d=>n.value.password=d),id:"password",class:"col-span-3"},null,8,["modelValue"]),u.value.password&&v.editId===0?(c(),N("span",Me,w(u.value.password[0]),1)):$("",!0)]),o("div",Te,[t(y,{for:"repeat_password",class:"text-right"},{default:l(()=>[...s[16]||(s[16]=[i(" Repeat Password ",-1),o("span",{class:"text-red-400"},"*",-1)])]),_:1}),t(x,{type:"password",modelValue:n.value.repeat_password,"onUpdate:modelValue":s[4]||(s[4]=d=>n.value.repeat_password=d),id:"repeat_password",class:"col-span-3"},null,8,["modelValue"]),u.value.repeat_password&&v.editId===0?(c(),N("span",Ae,w(u.value.repeat_password[0]),1)):$("",!0),U.value&&v.editId===0?(c(),N("span",Ke,w(U.value),1)):$("",!0)]),o("div",je,[t(y,{for:"repeat_password",class:"text-right"},{default:l(()=>[...s[17]||(s[17]=[i(" Role ",-1),o("span",{class:"text-red-400"},"*",-1)])]),_:1}),t(e(xe),{modelValue:n.value.role,"onUpdate:modelValue":s[5]||(s[5]=d=>n.value.role=d)},{default:l(()=>[t(e(ke),{class:"col-span-3"},{default:l(()=>[t(e($e),{placeholder:"Select a role"})]),_:1}),t(e(be),null,{default:l(()=>[t(e(Ue),null,{default:l(()=>[t(e(q),{value:"admin"},{default:l(()=>[...s[18]||(s[18]=[i("Admin",-1)])]),_:1}),t(e(q),{value:"user"},{default:l(()=>[...s[19]||(s[19]=[i("User",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),t(e(le),{class:"rc-dialog-footer bg-rcgray-800"},{default:l(()=>[t(h,{type:"close",variant:"outline",class:"px-2 py-1 ml-2 text-sm hover:bg-gray-700 hover:animate-pulse",onClick:s[6]||(s[6]=d=>e(_)("DialogNewUser")),size:"sm"},{default:l(()=>[...s[20]||(s[20]=[i(" Cancel ",-1),o("div",{class:"pl-2 ml-auto"},[o("kbd",{class:"rc-kdb-class"},"ESC")],-1)])]),_:1}),f.editId===0?(c(),D(h,{key:0,type:"submit",class:"px-2 py-1 ml-2 text-sm bg-blue-600 hover:bg-blue-700 hover:animate-pulse",size:"sm",onClick:s[7]||(s[7]=d=>I()),variant:"primary"},{default:l(()=>[s[22]||(s[22]=i(" Save ",-1)),o("div",Be,[o("kbd",Re,[s[21]||(s[21]=i(" Ctrl  ",-1)),t(T,{icon:"uil:enter",class:""})])])]),_:1})):$("",!0),f.editId>0?(c(),D(h,{key:1,type:"submit",class:"px-2 py-1 ml-2 text-sm bg-blue-600 hover:bg-blue-700 hover:animate-pulse",size:"sm",onClick:s[8]||(s[8]=d=>I()),variant:"primary"},{default:l(()=>[s[24]||(s[24]=i(" Update ",-1)),o("div",Fe,[o("kbd",Oe,[s[23]||(s[23]=i(" Ctrl  ",-1)),t(T,{icon:"uil:enter",class:""})])])]),_:1})):$("",!0)]),_:1})]),_:1})]),_:1},8,["open"])}}};function Ge(){const v=g(1),V=g(parseInt(localStorage.getItem("perPage")||"10")),k=g("-id"),P=g(""),L=g({}),_=Q(),C=g(0),S=g(!1),u=g(1),n=g(1),U=g([]),{openDialog:f}=_,{toastSuccess:M,toastError:I}=H();async function m(a={}){S.value=!0;try{const E=await F.get("/api/users",{params:{page:v.value,perPage:V.value,sort:k.value,...L.value}});U.value=E.data,u.value=E.data.last_page}catch(E){console.error("Error fetching users:",E),I("Error","Failed to fetch users.")}finally{S.value=!1}}const s=a=>{C.value=0,n.value=Math.random(),f("DialogNewUser")};function p(a){C.value=a,n.value=Math.random(),f("DialogNewUser")}const y=async a=>{try{await F.delete(`/api/users/${a}`),m(),M("User Deleted","The user has been deleted successfully.")}catch(E){console.error("Error deleting user:",E),I("Error","Failed to delete user.")}},x=a=>{C.value=a,n.value=Math.random(),f("DialogNewUser")},h=()=>{m(),n.value=Math.random()};function T(a){a.altKey&&a.key==="n"&&(a.preventDefault(),f("DialogNewUser"))}const d=ne(()=>{L.value["filter[name]"]=P.value,v.value=1,m()},500);R([v,V],()=>{m()}),R(P,()=>{d()}),R(V,a=>{localStorage.setItem("perPage",a.toString())});function O(a){k.value===a?k.value=`-${a}`:k.value=a,m()}return{users:U,isLoading:S,currentPage:v,perPage:V,lastPage:u,editId:C,newUserModalKey:n,searchTerm:P,openDialog:f,fetchUsers:m,createUser:s,updateUser:p,deleteUser:y,handleSave:h,handleKeyDown:T,viewEditDialog:x,toggleSort:O,sortParam:k}}const Je={class:"flex flex-col h-full gap-1 text-center"},We={class:"flex items-center justify-between p-4"},qe={class:"flex items-center"},He={class:"flex"},Qe={class:"px-6"},ss={__name:"Main",setup(v){const{editId:V,users:k,currentPage:P,perPage:L,searchTerm:_,lastPage:C,isLoading:S,fetchUsers:u,viewEditDialog:n,createUser:U,deleteUser:f,handleSave:M,handleKeyDown:I,newUserModalKey:m,toggleSort:s,sortParam:p}=Ge(),{selectedRows:y,selectAll:x,toggleSelectAll:h,toggleSelectRow:T}=ce(k),d=re();return X(()=>{u(),window.addEventListener("keydown",I),d.params.userId&&parseInt(d.params.userId,10)>0&&n(d.params.userId)}),Y(()=>{window.removeEventListener("keydown",I)}),(O,a)=>{const E=b("Input"),A=b("Button"),z=b("Checkbox"),B=b("Icon"),Z=b("Toaster");return c(),N("div",Je,[o("div",We,[o("div",qe,[t(E,{class:"max-w-sm ml-4 mr-2",autocomplete:"off","data-1p-ignore":"","data-lpignore":"true",placeholder:"Filter users...",modelValue:e(_),"onUpdate:modelValue":a[0]||(a[0]=r=>J(_)?_.value=r:null)},null,8,["modelValue"]),e(_)?(c(),D(me,{key:0,"onUpdate:modelValue":a[1]||(a[1]=r=>_.value="")})):$("",!0)]),o("div",He,[e(y).length?(c(),D(A,{key:0,class:"px-2 py-1 bg-red-600 hover:bg-red-700 hover:animate-pulse",size:"md",variant:"primary"},{default:l(()=>[i(" Delete Selected "+w(e(y).length)+" User(s) ",1)]),_:1})):$("",!0),t(A,{type:"submit",class:"px-2 py-1 ml-2 text-sm bg-blue-600 hover:bg-blue-700 hover:animate-pulse",size:"sm",onClick:de(e(U),["prevent"]),variant:"primary"},{default:l(()=>[...a[11]||(a[11]=[i(" New User ",-1),o("div",{class:"pl-2 ml-auto"},[o("kbd",{class:"rc-kdb-class2"},"ALT N")],-1)])]),_:1},8,["onClick"])])]),o("div",Qe,[t(e(we),null,{default:l(()=>[t(e(pe),null,{default:l(()=>[t(e(W),null,{default:l(()=>[t(e(K),{class:"w-[2%]"},{default:l(()=>[t(z,{id:"selectAll",modelValue:e(x),"onUpdate:modelValue":a[2]||(a[2]=r=>J(x)?x.value=r:null),onClick:a[3]||(a[3]=r=>e(h)())},null,8,["modelValue"])]),_:1}),t(e(K),{class:"w-[5%]"},{default:l(()=>[t(A,{class:"flex justify-start w-full p-0 hover:bg-rcgray-800",variant:"ghost",onClick:a[4]||(a[4]=r=>e(s)("id"))},{default:l(()=>[t(B,{icon:e(p)==="id"?"lucide:sort-asc":e(p)==="-id"?"lucide:sort-desc":"hugeicons:sorting-05"},null,8,["icon"]),a[12]||(a[12]=o("span",{class:"ml-2"},"ID",-1))]),_:1})]),_:1}),t(e(K),{class:"w-[20%]"},{default:l(()=>[t(A,{class:"flex justify-start w-full p-0 hover:bg-rcgray-800",variant:"ghost",onClick:a[5]||(a[5]=r=>e(s)("name"))},{default:l(()=>[t(B,{icon:e(p)==="name"?"lucide:sort-asc":e(p)==="-name"?"lucide:sort-desc":"hugeicons:sorting-05"},null,8,["icon"]),a[13]||(a[13]=o("span",{class:"ml-2"},"Name",-1))]),_:1})]),_:1}),t(e(K),{class:"w-[20%]"},{default:l(()=>[t(A,{class:"flex justify-start w-full p-0 hover:bg-rcgray-800",variant:"ghost",onClick:a[6]||(a[6]=r=>e(s)("email"))},{default:l(()=>[t(B,{icon:e(p)==="email"?"lucide:sort-asc":e(p)==="-email"?"lucide:sort-desc":"hugeicons:sorting-05"},null,8,["icon"]),a[14]||(a[14]=o("span",{class:"ml-2"},"Email",-1))]),_:1})]),_:1}),t(e(K),{class:"w-[20%]"},{default:l(()=>[t(A,{class:"flex justify-start w-full p-0 hover:bg-rcgray-800",variant:"ghost",onClick:a[7]||(a[7]=r=>e(s)("last_login"))},{default:l(()=>[t(B,{icon:e(p)==="last_login"?"lucide:sort-asc ":e(p)==="-last_login"?"lucide:sort-desc":"hugeicons:sorting-05"},null,8,["icon"]),a[15]||(a[15]=o("span",{class:"ml-2"},"Last Login",-1))]),_:1})]),_:1}),t(e(K),{class:"w-[10%]"},{default:l(()=>[...a[16]||(a[16]=[i("Actions",-1)])]),_:1})]),_:1})]),_:1}),t(e(fe),null,{default:l(()=>[e(S)?(c(),D(ge,{key:0})):e(S)?(c(),D(_e,{key:2})):(c(!0),N(ie,{key:1},ue(e(k).data,r=>(c(),D(e(W),{key:r.id},{default:l(()=>[t(e(j),{class:"text-start"},{default:l(()=>[t(z,{class:"cursor-pointer",id:"select-"+r.id,checked:!!e(y).includes(r.id),onClick:G=>e(T)(r.id)},null,8,["id","checked","onClick"])]),_:2},1024),t(e(j),{class:"text-start"},{default:l(()=>[i(w(r.id),1)]),_:2},1024),t(e(j),{class:"text-start"},{default:l(()=>[i(w(r.name),1)]),_:2},1024),t(e(j),{class:"text-start"},{default:l(()=>[i(w(r.email),1)]),_:2},1024),t(e(j),{class:"text-start"},{default:l(()=>[i(w(r.last_login),1)]),_:2},1024),t(e(j),{class:"text-start"},{default:l(()=>[t(ve,{rowData:r,onOnEdit:G=>e(n)(r.id),onOnDelete:G=>e(f)(r.id)},null,8,["rowData","onOnEdit","onOnDelete"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),t(ye,{currentPage:e(P),lastPage:e(C),perPage:e(L),"onUpdate:currentPage":a[8]||(a[8]=r=>P.value=r),"onUpdate:perPage":a[9]||(a[9]=r=>L.value=r)},null,8,["currentPage","lastPage","perPage"]),(c(),D(ze,{onSave:a[10]||(a[10]=r=>e(M)()),key:e(m),editId:e(V)},null,8,["editId"])),t(Z)])])}}};export{ss as default};
